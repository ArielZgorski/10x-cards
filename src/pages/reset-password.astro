---
import Layout from '../layouts/Layout.astro';
import { AuthProvider } from '../components/auth/AuthProvider';
import { ResetPasswordForm } from '../components/forms/ResetPasswordForm';

// Get token from URL parameters
const { searchParams } = Astro.url;
const token = searchParams.get('token');
---

<Layout title="Nowe hasÅ‚o - 10x Cards">
  <div class="reset-password-page">
    <div class="reset-password-container">
      <div class="reset-password-card">
        <AuthProvider client:only="react">
          <ResetPasswordForm client:only="react" token={token} />
        </AuthProvider>
      </div>
    </div>
  </div>
</Layout>

<!-- Import form styles -->
<link rel="stylesheet" href="/src/components/forms/form-styles.css">

<script>
  // Check if already logged in and redirect
  document.addEventListener("DOMContentLoaded", () => {
    const token = localStorage.getItem("supabase_token");
    if (token) {
      window.location.href = "/ai/generations";
    }
  });
</script>

<style>
  .reset-password-page {
    min-height: 100vh;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }
  
  .reset-password-container {
    width: 100%;
    max-width: 450px;
  }
  
  .reset-password-card {
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    min-height: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Mobile responsive */
  @media (max-width: 640px) {
    .reset-password-page {
      padding: 1rem 0.75rem;
    }
    
    .reset-password-card {
      padding: 1.5rem;
      min-height: 350px;
    }
  }
</style>
